library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + RACE + MARST + INCWAGE + ELDCH + black + white,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + RACE + MARST + INCWAGE + ELDCH,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
summary(att_NT)
summary(att_cs_NT)
summary(att_cs_NYT)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + RACE + MARST + INCWAGE + ELDCH,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
summary(att_cs_NT)
att_cs_NYT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + BLACK + WHITE + UNEMPLOYMENTRATE,
control_group = "notyettreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
View(df1)
att_cs_NYT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + black + white + UNEMPLOYMENTRATE,
control_group = "notyettreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
att_cs_NYT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + black + white,
control_group = "notyettreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
att_cs_NYT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + black,
control_group = "notyettreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
att_cs_NYT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + factor(RACE),
control_group = "notyettreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC+ MARST + ELDC + factor(RACE),
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC+ MARST + ELDCH + factor(RACE),
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
table(df1$RACE)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC+ MARST + ELDCH + black + white ,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
table(df1$black)
table(df1$white)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC+ MARST + ELDCH + black,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC+ MARST + ELDCH,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
warnings()
table(df1$ASECWT)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC+ MARST + ELDCH + black + white,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0)
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC+ MARST + ELDCH + black,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
table(df1$RACE)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0) %>%
mutate(RACE = factor(RACE))
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0) %>%
mutate(RACE = factor(RACE))
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + RACE,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0) %>%
mutate(RACE = factor(RACE))
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
View(df1)
summary(att_cs_NT)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0) %>%
mutate(RACE = factor(RACE))
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
summary(att_cs_NT)
agg_dyn_NT <- aggte(att_cs_NT, type = "dynamic")
summary(agg_dyn)
summary(agg_dyn_NT)
agg_dyn_NT <- aggte(att_cs_NT, type = "dynamic")
summary(agg_dyn_NT)
ggdid(agg_dyn_NT)
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + RACE + UNEMPLOYMENTRATE + median_weekly_wage,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "dr"
)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0) %>%
mutate(RACE = factor(RACE))
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + RACE + UNEMPLOYMENTRATE + median_weekly_wage,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "reg"
)
# Import packages
library(tidyverse)
library(lubridate)
library(did)
# Import cleaned data
df <- readRDS("../cleaned_data/finalmerged.rds")
# Remove all observations where year > repeal year
df1 <- df %>%
filter(is.na(repeal_year) | YEAR <= repeal_year) %>%
filter(ASECWT != 0) %>%
mutate(RACE = factor(RACE))
colnames(df1)
# For never-treated units, we set treat_start_year to be 0, to be consistent with how the package wants it
df1$treat_start_year[is.na(df1$treat_start_year)] <- 0
# Group-time ATT for never-treated
att_cs_NT <- att_gt(
yname   = "birth_lastyear",
tname   = "YEAR",
gname   = "treat_start_year",
xformla = ~ AGE + NCHILD + EDUC + MARST + ELDCH + UNEMPLOYMENTRATE + median_weekly_wage,
control_group = "nevertreated",
weightsname = "ASECWT",
data = df1,
panel = F, # we are using repeated cross-sectional data
anticipation = 0,
clustervars = "STATEFIP",
est_method = "reg"
)
summary(att_cs_NT)
agg_dyn_NT <- aggte(att_cs_NT, type = "dynamic")
summary(agg_dyn_NT)
ggdid(agg_dyn_NT)
